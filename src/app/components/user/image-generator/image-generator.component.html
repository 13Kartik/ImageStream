<form [formGroup]="activeFontProperties" (submit)="onSubmit()">
    <div class="row">
        <app-options-menu 
        class="col-3" 
        [options]="activeFontProperties.controls"
        (onOpacityChange)="setOpacity($event)"
        (onAddTextBox)="this.addTextBox()"
        >
        </app-options-menu>

            <div id="img-preview" class="col-9 d-flex justify-content-center align-items-center">
                @if(img_src===undefined){
                    <div
                    class="card w-50 h-50 d-flex justify-content-center align-items-center border-primary"
                    (click)="openSetImageModal()"
                    >
                        <fa-icon 
                        [icon]="uploadIcon"
                        class="text-primary"
                        style="font-size: 60px;"
                        ></fa-icon>
                        <h5 class="text-secondary">Set Image</h5>
                    </div>
                }
                @else {
                    <div class="d-flex align-items-center justify-content-end change-img-btn" style="width:5%;">     
                        <div class="btn bg-primary" placement="left" ngbTooltip="change Image">
                            <fa-icon [icon]="changeImgIcon" class="text-white fs-3" (click)="openSetImageModal()"></fa-icon>
                        </div>
                    </div>
                    <div
                    #imgContainer
                    class="img-container" 
                    [ngStyle]="{
                                'width':'auto',
                                'height':'100%',
                                'aspect-ratio':this.aspectRatio,
                                'background-image': 'linear-gradient(rgba(255, 255, 255,'+(1-imageOpacity)+'), rgba(255, 255, 255, '+(1-imageOpacity)+')), url(' + img_src + ')',
                                'margin-right':'5%',
                                }"
                    >
                        <app-text-box 
                        *ngFor="let textBox of fontProperties; let index = index"
                        [id]="'textBox_'+index"
                        [fontControls]="textBox.controls" 
                        (click)="changeTextBox(index)"
                        (onDelete)="deleteTextBox(index)"
                        >
                        </app-text-box>
                    </div>
                }
            </div>
    </div>
</form>

<!-- Modal -->
<ng-template #generatedLinkModal let-modal>

    <!-- Alert -->
    <div class="alert-container" [ngStyle]="{'display':showAlert?'flex':'none'}">
        <div class="alert alert-primary" role="alert">
            Link has been copied to Clipboard
        </div>
    </div>

	<div class="modal-header">
		<h4 class="modal-title">Generated Link</h4>
		<button type="button" class="btn-close" aria-label="Close" (click)="modal.dismiss('Cross click')"></button>
	</div>
	<div class="modal-body">
		<div class="row">
            <div class="col-10 d-flex align-items-center justify-content-center"><a [href]="generatedLink" target="_blank" class="pb-2" style="white-space: nowrap; overflow: auto;">{{generatedLink}}</a></div>
            <div class="col-2" (click)="copyLink()">
                <fa-icon class="btn btn-outline-primary" [icon]="copyIcon" placement="bottom" ngbTooltip="Copy Generated Link"></fa-icon>
            </div>
        </div>
	</div>
	<div class="modal-footer justify-content-center">
		<button type="button" class="btn btn-success" (click)="modal.close('Close click')">Continue</button>
	</div>
</ng-template>

<app-select-image #appSelectImageRef class="modal-body" (onSetImage)="handleImageUrl($event)"></app-select-image>